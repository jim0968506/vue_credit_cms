{"ast":null,"code":"import axios from \"axios\";\nimport router from \"@/router\";\n\n//Notification是一種錯誤提醒\nimport { Message, Notification } from \"element-ui\";\nconst request = axios.create({\n  //設定/api字首\n  baseURL: \"/api\"\n});\n//請求攔截器\nrequest.interceptors.request.use(config => {\n  //下面是加的內容\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    config.headers.token = token;\n  }\n  return config;\n});\n//響應攔截器\nrequest.interceptors.response.use(response => {\n  //20000代表成功\n  if (response?.data?.code === 20000) {\n    // 由於歷史遺留問題, 後端響應的結構不能一次性做到統一,相容處理一下\n    if (typeof response?.data?.data === \"string\") Message.success(response?.data?.data);\n    if (typeof response?.data?.data?.info === \"string\") Message.success(response?.data?.data?.info);\n    return response;\n\n    // 603 代表token失效, 處理跳轉到登入\n  } else if (response?.data?.code === 603) {\n    Notification.error({\n      title: \"錯誤\",\n      message: \"token失效,請重新登入\"\n    });\n    // 替換到登入頁面，但是如果是login頁面那就不重複跳轉\n    let url = window.location.href.split(\"/\");\n    if (url[url.length - 1] !== \"login\") {\n      router.replace(\"/login\");\n    }\n  } else {\n    //如果原始的請求狀態不等於200表示響應錯誤\n    if (response.status !== 200) {\n      Notification.error({\n        title: \"錯誤\",\n        message: \"響應錯誤\"\n      });\n    }\n  }\n  return response;\n});\nexport default request;","map":{"version":3,"names":["axios","router","Message","Notification","request","create","baseURL","interceptors","use","config","token","localStorage","getItem","headers","response","data","code","success","info","error","title","message","url","window","location","href","split","length","replace","status"],"sources":["C:/Users/jim09/Desktop/cms/vue-project/src/utils/request.js"],"sourcesContent":["import axios from \"axios\"\r\nimport router from \"@/router\"\r\n\r\n//Notification是一種錯誤提醒\r\nimport { Message, Notification } from \"element-ui\"\r\n\r\nconst request = axios.create({\r\n  //設定/api字首\r\n  baseURL: \"/api\",\r\n})\r\n//請求攔截器\r\nrequest.interceptors.request.use((config) => {\r\n  //下面是加的內容\r\n  const token = localStorage.getItem(\"token\")\r\n  if (token) {\r\n    config.headers.token = token\r\n  }\r\n  return config\r\n})\r\n//響應攔截器\r\nrequest.interceptors.response.use((response) => {\r\n  //20000代表成功\r\n  if (response?.data?.code === 20000) {\r\n    // 由於歷史遺留問題, 後端響應的結構不能一次性做到統一,相容處理一下\r\n    if (typeof response?.data?.data === \"string\")\r\n      Message.success(response?.data?.data)\r\n    if (typeof response?.data?.data?.info === \"string\")\r\n      Message.success(response?.data?.data?.info)\r\n    return response\r\n\r\n    // 603 代表token失效, 處理跳轉到登入\r\n  } else if (response?.data?.code === 603) {\r\n    Notification.error({\r\n      title: \"錯誤\",\r\n      message: \"token失效,請重新登入\",\r\n    })\r\n    // 替換到登入頁面，但是如果是login頁面那就不重複跳轉\r\n    let url = window.location.href.split(\"/\")\r\n    if (url[url.length - 1] !== \"login\") {\r\n      router.replace(\"/login\")\r\n    }\r\n  } else {\r\n    //如果原始的請求狀態不等於200表示響應錯誤\r\n    if (response.status !== 200) {\r\n      Notification.error({\r\n        title: \"錯誤\",\r\n        message: \"響應錯誤\",\r\n      })\r\n    }\r\n  }\r\n  return response\r\n})\r\n\r\nexport default request\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,UAAU;;AAE7B;AACA,SAASC,OAAO,EAAEC,YAAY,QAAQ,YAAY;AAElD,MAAMC,OAAO,GAAGJ,KAAK,CAACK,MAAM,CAAC;EAC3B;EACAC,OAAO,EAAE;AACX,CAAC,CAAC;AACF;AACAF,OAAO,CAACG,YAAY,CAACH,OAAO,CAACI,GAAG,CAAEC,MAAM,IAAK;EAC3C;EACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACI,OAAO,CAACH,KAAK,GAAGA,KAAK;EAC9B;EACA,OAAOD,MAAM;AACf,CAAC,CAAC;AACF;AACAL,OAAO,CAACG,YAAY,CAACO,QAAQ,CAACN,GAAG,CAAEM,QAAQ,IAAK;EAC9C;EACA,IAAIA,QAAQ,EAAEC,IAAI,EAAEC,IAAI,KAAK,KAAK,EAAE;IAClC;IACA,IAAI,OAAOF,QAAQ,EAAEC,IAAI,EAAEA,IAAI,KAAK,QAAQ,EAC1Cb,OAAO,CAACe,OAAO,CAACH,QAAQ,EAAEC,IAAI,EAAEA,IAAI,CAAC;IACvC,IAAI,OAAOD,QAAQ,EAAEC,IAAI,EAAEA,IAAI,EAAEG,IAAI,KAAK,QAAQ,EAChDhB,OAAO,CAACe,OAAO,CAACH,QAAQ,EAAEC,IAAI,EAAEA,IAAI,EAAEG,IAAI,CAAC;IAC7C,OAAOJ,QAAQ;;IAEf;EACF,CAAC,MAAM,IAAIA,QAAQ,EAAEC,IAAI,EAAEC,IAAI,KAAK,GAAG,EAAE;IACvCb,YAAY,CAACgB,KAAK,CAAC;MACjBC,KAAK,EAAE,IAAI;MACXC,OAAO,EAAE;IACX,CAAC,CAAC;IACF;IACA,IAAIC,GAAG,GAAGC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC;IACzC,IAAIJ,GAAG,CAACA,GAAG,CAACK,MAAM,GAAG,CAAC,CAAC,KAAK,OAAO,EAAE;MACnC1B,MAAM,CAAC2B,OAAO,CAAC,QAAQ,CAAC;IAC1B;EACF,CAAC,MAAM;IACL;IACA,IAAId,QAAQ,CAACe,MAAM,KAAK,GAAG,EAAE;MAC3B1B,YAAY,CAACgB,KAAK,CAAC;QACjBC,KAAK,EAAE,IAAI;QACXC,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;EACF;EACA,OAAOP,QAAQ;AACjB,CAAC,CAAC;AAEF,eAAeV,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}